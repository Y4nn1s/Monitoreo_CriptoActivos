<!-- Contenedor principal: Gestiona el diseño de la tarjeta y reacciona al estado de alerta -->
<div
  class="relative p-6 rounded-2xl backdrop-blur-md transition-all duration-300 hover:transform hover:-translate-y-1 hover:shadow-xl hover:shadow-blue-500/10"
  [ngClass]="
    isAlertActive()
      ? 'border-2 border-amber-400 bg-amber-400/5 shadow-lg shadow-amber-500/20'
      : 'border border-white/10 bg-white/5'
  "
  [attr.id]="'card-' + data().id"
  *appHighlightChange="data().price; alert: isAlertActive()"
>
  <!-- Encabezado: Identidad visual del activo y precio actual -->
  <div class="flex justify-between items-start mb-4">
    <div class="flex items-center gap-3">
      <!-- Icono Dinámico: Generado a partir del símbolo para una carga instantánea -->
      <div
        class="w-10 h-10 rounded-full bg-linear-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white font-bold text-sm shadow-lg shadow-blue-500/30"
      >
        {{ data().symbol }}
      </div>
      <div>
        <div class="flex items-center gap-2">
          <h3 class="text-white font-bold text-lg tracking-tight">{{ data().name }}</h3>
          
          <!-- Indicador de Alerta Crítica: Solo visible si se supera el umbral del usuario -->
          @if (isAlertActive()) {
            <svg class="h-5 w-5 text-amber-400 animate-pulse" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
            </svg>
          }
        </div>
        <span class="text-slate-400 text-[10px] font-bold uppercase tracking-widest"
          >Volumen: {{ data().volume | number: '1.0-0' }}</span>
      </div>
    </div>
    
    <!-- Sección de Rendimiento: Precio formateado y variación porcentual -->
    <div class="text-right">
      <div class="text-white font-mono font-bold text-xl tracking-tight">
        ${{ data().price | number: '1.2-4' }}
      </div>
      <!-- Badge de cambio: Verde para ganancias, Rojo para pérdidas -->
      <div
        class="text-[10px] font-black px-2 py-0.5 rounded-full inline-block mt-1 uppercase"
        [ngClass]="
          data().changePercent >= 0
            ? 'bg-emerald-500/10 text-emerald-400'
            : 'bg-red-500/10 text-red-400'
        "
      >
        {{ data().changePercent >= 0 ? '▲' : '▼' }} {{ data().changePercent | number: '1.2-2' }}%
      </div>
    </div>
  </div>

  <!-- Barra de Tendencia: Proporción visual de la volatilidad actual -->
  <div class="w-full bg-slate-700/30 h-1 rounded-full overflow-hidden">
    <div
      class="h-full transition-all duration-500 ease-out"
      [ngClass]="data().changePercent >= 0 ? 'bg-emerald-500' : 'bg-red-500'"
      [style.width.%]="50 + data().changePercent * 5"
    ></div>
  </div>

  <!-- Puntos de notificación flotantes para alertas activas -->
  @if (isAlertActive()) {
    <div class="absolute -top-1 -right-1 w-3 h-3 bg-amber-400 rounded-full animate-ping"></div>
    <div class="absolute -top-1 -right-1 w-3 h-3 bg-amber-400 rounded-full border-2 border-slate-900"></div>
  }
</div>
